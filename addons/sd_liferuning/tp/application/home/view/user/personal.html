{extend name="public/base" /}
{block name="content"}

{__block__}
<input type="hidden" name="mun_url" id="mun_url" value="11,10,false,用户中心"/>
<link href="__STATIC__/home/csc/css/font_353057_xjg7zdpmf54mfgvi.css" rel="stylesheet">
<link href="__STATIC__/home/csc/css/bootstrap.min.css" rel="stylesheet">
<link href="__STATIC__/home/csc/css/jquery.datetimepicker.min.css" rel="stylesheet">
<link href="__STATIC__/home/csc/css/flex.css" rel="stylesheet">
<link href="__STATIC__/home/csc/css/common.css" rel="stylesheet">
<link href="__STATIC__/home/csc/css/common.v2.css" rel="stylesheet">
<!--<link rel="stylesheet" href="__STATIC__/home/csc/css/layer.css" id="layuicss-layer">
<link rel="stylesheet" href="__STATIC__/home/csc/css/laydate.css" id="layuicss-laydate">-->
<script src="__STATIC__/home/csc/js/jquery.min.js"></script>
<script src="__STATIC__/home/csc/js/vue.js"></script>
<script src="__STATIC__/home/csc/js/tether.min.js"></script>
<script src="__STATIC__/home/csc/js/bootstrap.min.js"></script>
<script src="__STATIC__/home/csc/js/plupload.full.min.js"></script>
<script src="__STATIC__/home/csc/js/jquery.datetimepicker.full.min.js"></script>
<script src="__STATIC__/home/csc/js/common.js"></script>
<script src="__STATIC__/home/csc/js/common.v2.js"></script>
<script src="__STATIC__/home/csc/js/clipboard.js"></script>
<!--<script src="__STATIC__/home/csc/js/layer.js"></script>
<script src="__STATIC__/home/csc/js/laydate.js"></script>-->

<style>
    .panel-headers{border-bottom: 1px solid #eee;padding: 1rem 0;}
    .modal-sm .panel{padding:0 1rem;}
    .modal-dialog .panel{padding:0 1rem;}
    .radio-label, .checkbox-label{line-height: normal;height: auto;}
    .btn{font-size: 14px;}
    .panel .a{color: #0275d8;}
    .panel{font-size: 14px;padding: 0;}
    .panel .panel-header{height: 80px;line-height: 80px;padding:0;padding-left: 28px;}
    .mobile-box {
        width: 219px;
        height: 450px;
        background-image: url("https://xam.chaojiyuanma.com/addons/zjhj_mall/core/web/statics/images/mobile-iphone.png");
        background-size: cover;
        position: relative;
        font-size: .85rem;
        float: left;
        margin-right: 1rem;margin-left: 1rem;
    }

    .mobile-box .mobile-screen{
        position: absolute;
        top: 52px;
        left: 12px;
        right: 13px;
        bottom: 54px;
        border: 1px solid #999;
        background: #f5f7f9;
        overflow-y: hidden;
    }

    .mobile-box .mobile-navbar {
        position: absolute;
        top: 0px;
        left: 0px;
        right: 0px;
        height: 38px;
        line-height: 38px;
        text-align: center;
        background: #fff;
    }

    .mobile-box .mobile-content {
        position: absolute;
        top: 38px;
        left: 0;
        right: 0;
        bottom: 0;
        overflow-y: auto;
    }

    .mobile-box .mobile-content::-webkit-scrollbar {
        width: 2px;
    }

    .content-block.header-block {
        height: 89px;
        padding: 1rem;
        background-size: cover;
        background-position: center;
    }

    .content-block.menu-block {
        margin: .25rem 0 1rem;
    }

    .right-box .order-list > div {
        border: 1px solid #e3e3e3;
        border-right-width: 0;
        cursor: pointer;
    }

    .right-box .order-list > div:hover {
        background: #f6f8f9;
    }

    .right-box .order-list > div:last-child {
        border-right-width: 1px;
    }

    .right-box .menu-box {
        border: 1px solid #e3e3e3;
    }

    .right-box .menu-box .menu-header {
        padding: .5rem;
        border-bottom: 1px solid #e3e3e3;
    }

    .right-box .menu-box .menu-list {
        padding: .5rem;
        background: #f6f8f9;
    }

    .right-box .menu-box .menu-item {
        background: #fff;
        padding: .5rem;
        margin: .25rem 0;
    }

</style>
<div class="c-r right">
    <div class="panel mb-3" id="app" style="display: none">
        <div class="panel-header">用户中心</div>
        <div class="panel-body">
            <form class="" method="post">

                <div flex="dir:left box:first">
                    <div class="left-box">
                        <div class="mobile-box">
                            <div class="mobile-screen">
                                <div class="mobile-navbar">用户中心</div>
                                <div class="mobile-content">
                                    <div class="content-block header-block" :style="c_user_center_bg">
                                        <div flex="dir:left box:first" v-if="top_style == 0">
                                            <div>
                                                <div style="display: inline-block;border: 2px solid #fff;background: #e3e3e3;width: 35px;height: 35px;border-radius: 999px"></div>
                                            </div>
                                            <div style="font-weight: bold;color: #fff;padding: .5rem 1rem">用户昵称</div>
                                        </div>
                                        <div flex="dir:left main:center" v-if="top_style == 1">
                                            <div class="text-center">
                                                <div style="display: inline-block;border: 2px solid #fff;background: #e3e3e3;width: 35px;height: 35px;border-radius: 999px"></div>
                                                <div style="font-weight: bold;color: #fff;">用户昵称</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="content-block order-block bg-white" v-if="false">
                                        <div style="padding: .35rem .75rem;border-bottom: 1px solid #eee">全部订单</div>
                                        <div flex="dir:left box:mean" v-if="orders">
                                            <div class="text-center pt-1 pb-1">
                                                <img :src="orders.status_0.icon" style="width: 17px;height: 16px">
                                                <div style="transform: scale(0.8);">{{orders.status_0.text}}</div>
                                            </div>
                                            <div class="text-center pt-1 pb-1">
                                                <img :src="orders.status_1.icon" style="width: 17px;height: 16px">
                                                <div style="transform: scale(0.8);">{{orders.status_1.text}}</div>
                                            </div>
                                            <div class="text-center pt-1 pb-1">
                                                <img :src="orders.status_2.icon" style="width: 17px;height: 16px">
                                                <div style="transform: scale(0.8);">{{orders.status_2.text}}</div>
                                            </div>
                                            <div class="text-center pt-1 pb-1">
                                                <img :src="orders.status_3.icon" style="width: 17px;height: 16px">
                                                <div style="transform: scale(0.8);">{{orders.status_3.text}}</div>
                                            </div>
                                            <div class="text-center pt-1 pb-1">
                                                <img :src="orders.status_4.icon" style="width: 17px;height: 16px">
                                                <div style="transform: scale(0.8);">{{orders.status_4.text}}</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="content-block menu-block">
                                        <div flex="dir:left box:justify cross:center" v-if="menu_style == 0"
                                             v-for="(item,index) in menus"
                                             style="background: #fff;border-bottom: 1px solid #eee;padding: .25rem .5rem;">
                                            <div>
                                                <img :src="item.icon" style="width: 15px;height: 15px;">
                                            </div>
                                            <div class="pl-2">{{item.name}}</div>
                                        </div>
                                        <div flex="dir:left cross:center" v-if="menu_style == 1"
                                             style="background: #fff;border-bottom: 1px solid #eee;padding: .25rem .5rem;flex-wrap: wrap">
                                            <div class="text-center" v-for="(item,index) in menus" style="width: 25%;">
                                                <img :src="item.icon" style="width: 15px;height: 15px;">
                                                <div>{{item.name}}</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="content-block copyright-block text-center" v-if="copyright">
                                        <img v-if="copyright.icon" :src="copyright.icon" style="height: 18px">
                                        <div class="fs-sm mb-2">{{copyright.text}}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="right-box">
                        <div class="form-group row">
                            <div class="form-group-label col-sm-2 text-right">
                                <label class="col-form-label">头部背景图片</label>
                            </div>
                            <div class="col-sm-6">
                                <div class="upload-group">
                                    <div class="input-group">
                                        <input class="form-control file-input" name="user_center_bg"
                                               v-model.lazy="user_center_bg">
                                        <span class="input-group-btn">
                                        <a class="btn btn-secondary upload-file" href="javascript:"
                                           data-toggle="tooltip"
                                           data-placement="bottom" title="上传文件">
                                            <span class="iconfont icon-cloudupload"></span>
                                        </a>
                                    </span>
                                        <span class="input-group-btn">
                                        <a class="btn btn-secondary delete-file" href="javascript:"
                                           data-toggle="tooltip"
                                           data-placement="bottom" title="删除文件">
                                            <span class="iconfont icon-close"></span>
                                        </a>
                                    </span>
                                    </div>
                                    <div class="upload-preview text-center upload-preview">
                                        <span class="upload-preview-tip">750&times;348</span>
                                        <img class="upload-preview-img" :src="user_center_bg">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="form-group-label col-sm-2 text-right">
                                <label class="col-form-label">头部样式</label>
                            </div>
                            <div class="col-sm-6 center_c" style="max-width: 360px">
                                <label class="radio-label">
                                    <input id="radio1" :checked="top_style==0?'checked':''"
                                           value="0"
                                           name="top_style" type="radio" class="custom-control-input" v-model="top_style">
                                    <span class="label-icon"></span>
                                    <span class="label-text">样式一</span>
                                </label>
                                <label class="radio-label">
                                    <input id="radio1"  :checked="top_style==1?'checked':''"
                                           value="1"
                                           name="top_style" type="radio" class="custom-control-input" v-model="top_style">
                                    <span class="label-icon"></span>
                                    <span class="label-text">样式二</span>
                                </label>
                            </div>
                        </div>
                        <div class="form-group row" v-if="false">
                            <div class="form-group-label col-sm-2 text-right">
                                <label class="col-form-label">订单栏</label>
                            </div>
                            <div class="col-sm-6 center_c" style="max-width: 360px">
                                <div class="order-list" flex="dir:left box:mean" v-if="orders">
                                    <div class="text-center pt-1 pb-1 edit-order" data-index="status_0">
                                        <img :src="orders.status_0.icon" style="width: 17px;height: 16px">
                                        <div style="transform: scale(0.8);">{{orders.status_0.text}}</div>
                                    </div>
                                    <div class="text-center pt-1 pb-1 edit-order" data-index="status_1">
                                        <img :src="orders.status_1.icon" style="width: 17px;height: 16px">
                                        <div style="transform: scale(0.8);">{{orders.status_1.text}}</div>
                                    </div>
                                    <div class="text-center pt-1 pb-1 edit-order" data-index="status_2">
                                        <img :src="orders.status_2.icon" style="width: 17px;height: 16px">
                                        <div style="transform: scale(0.8);">{{orders.status_2.text}}</div>
                                    </div>
                                    <div class="text-center pt-1 pb-1 edit-order" data-index="status_3">
                                        <img :src="orders.status_3.icon" style="width: 17px;height: 16px">
                                        <div style="transform: scale(0.8);">{{orders.status_3.text}}</div>
                                    </div>
                                    <div class="text-center pt-1 pb-1 edit-order" data-index="status_4">
                                        <img :src="orders.status_4.icon" style="width: 17px;height: 16px">
                                        <div style="transform: scale(0.8);">{{orders.status_4.text}}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="form-group-label col-sm-2 text-right">
                                <label class="col-form-label">菜单栏样式</label>
                            </div>
                            <div class="col-sm-6" style="max-width: 360px">
                                <label class="radio-label">
                                    <input id="radio1" :checked="menu_style==0?'checked':''"
                                           value="0"
                                           name="menu_type" type="radio" class="custom-control-input" v-model="menu_style">
                                    <span class="label-icon"></span>
                                    <span class="label-text">列表形式</span>
                                </label>
                                <label class="radio-label">
                                    <input id="radio1"  :checked="menu_style==1?'checked':''"
                                           value="1"
                                           name="menu_type" type="radio" class="custom-control-input" v-model="menu_style">
                                    <span class="label-icon"></span>
                                    <span class="label-text">九宫格形式</span>
                                </label>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="form-group-label col-sm-2 text-right">
                                <label class="col-form-label">菜单栏</label>
                            </div>
                            <div class="col-sm-6" style="max-width: 360px">
                                <div class="menu-box">
                                    <div class="menu-header clearfix">
                                        <a class="float-right a" href="javascript:" data-toggle="modal"
                                           data-target=".add-menu-modal">添加</a>
                                    </div>
                                    <div class="menu-list">
                                        <draggable :list="menus"
                                                   :options="{animation: 200,}">
                                            <transition-group name="list-complete">
                                                <div class="menu-item" flex="dir:left box:justify cross:center"
                                                     v-for="(item,index) in menus"
                                                     :key="index">
                                                    <div>
                                                        <img :src="item.icon" style="width: 21px;height: 21px;">
                                                    </div>
                                                    <div class="pl-3">{{item.name}}</div>
                                                    <div>
                                                        <a :data-index="index" href="javascript:" class="edit-menu a">编辑</a>
                                                        <a :data-index="index" href="javascript:" class="delete-menu a">删除</a>
                                                    </div>
                                                </div>
                                            </transition-group>
                                        </draggable>
                                    </div>

                                </div>
                            </div>
                        </div>

                        <template v-if="copyright && false">
                            <div class="form-group row">
                                <div class="form-group-label col-sm-2 text-right">
                                    <label class="col-form-label">底部版权文字</label>
                                </div>
                                <div class="col-sm-6" style="max-width: 360px">
                                    <input class="form-control" v-model="copyright.text">
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="form-group-label col-sm-2 text-right">
                                    <label class="col-form-label">底部版权图标</label>
                                </div>
                                <div class="col-sm-6" style="max-width: 360px">
                                    <div class="upload-group">
                                        <div class="input-group">
                                            <input class="form-control file-input" name="copyright_icon"
                                                   v-model.lazy="copyright.icon">
                                            <span class="input-group-btn">
                                        <a class="btn btn-secondary upload-file" href="javascript:"
                                           data-toggle="tooltip"
                                           data-placement="bottom" title="上传文件">
                                            <span class="iconfont icon-cloudupload"></span>
                                        </a>
                                    </span>
                                            <span class="input-group-btn">
                                        <a class="btn btn-secondary select-file" href="javascript:"
                                           data-toggle="tooltip"
                                           data-placement="bottom" title="从文件库选择">
                                            <span class="iconfont icon-viewmodule"></span>
                                        </a>
                                    </span>
                                            <span class="input-group-btn">
                                        <a class="btn btn-secondary delete-file" href="javascript:"
                                           data-toggle="tooltip"
                                           data-placement="bottom" title="删除文件">
                                            <span class="iconfont icon-close"></span>
                                        </a>
                                    </span>
                                        </div>
                                        <div class="upload-preview text-center upload-preview">
                                            <span class="upload-preview-tip">240&times;60</span>
                                            <img class="upload-preview-img" :src="copyright.icon">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="form-group-label col-sm-2 text-right">
                                    <label class="col-form-label">底部版权链接</label>
                                </div>
                                <div class="col-sm-6" style="max-width: 360px">
                                    <div class="input-group page-link-input">
                                        <input class="form-control link-input"
                                               readonly
                                               name="copyright_url"
                                               v-model="copyright.url">
                                        <input class="link-open-type"
                                               name="copyright_open_type"
                                               v-model="copyright.open_type"
                                               type="hidden">
                                        <span class="input-group-btn">
                                    <a class="btn btn-secondary pick-link-btn" href="javascript:">选择链接</a>
                                </span>
                                    </div>
                                </div>
                            </div>
                        </template>

                        <div class="form-group row">
                            <div class="form-group-label col-sm-2 text-right">
                            </div>
                            <div class="col-sm-6">
                                <a class="btn btn-primary save-user-center" href="javascript:">保存</a>
                                <a class="btn btn-secondary reset-navbar"
                                   href="UserReset">恢复默认设置</a>
                            </div>
                        </div>

                    </div>

                </div>
            </form>


            <div class="modal edit-order-modal" data-backdrop="static" style="z-index: 1041">
                <div class="modal-dialog" role="document">
                    <div class="panel">
                        <div class="panel-header">
                            <span>订单栏图标编辑</span>
                            <a href="javascript:" class="panel-close" data-dismiss="modal">×</a>
                        </div>
                        <div class="panel-body" v-if="edit_order">
                            <div class="form-group row">
                                <div class="form-group-label col-sm-2 text-right">
                                    <label class="col-form-label required">名称</label>
                                </div>
                                <div class="col-sm-8" style="display: inherit;">{{edit_order.text}}</div>
                            </div>
                            <div class="form-group row">
                                <div class="form-group-label col-sm-2 text-right">
                                    <label class="col-form-label required">图标</label>
                                </div>
                                <div class="col-sm-8">
                                    <div class="upload-group">
                                        <div class="input-group">
                                            <input class="form-control file-input" v-model.lazy="edit_order.icon"
                                                   name="edit_order_icon">
                                            <span class="input-group-btn">
                                        <a class="btn btn-secondary upload-file" href="javascript:"
                                           data-toggle="tooltip"
                                           data-placement="bottom" title="上传文件">
                                            <span class="iconfont icon-cloudupload"></span>
                                        </a>
                                    </span>
                                            <span class="input-group-btn">
                                        <a class="btn btn-secondary select-file" href="javascript:"
                                           data-toggle="tooltip"
                                           data-placement="bottom" title="从文件库选择">
                                            <span class="iconfont icon-viewmodule"></span>
                                        </a>
                                    </span>
                                            <span class="input-group-btn">
                                        <a class="btn btn-secondary delete-file" href="javascript:"
                                           data-toggle="tooltip"
                                           data-placement="bottom" title="删除文件">
                                            <span class="iconfont icon-close"></span>
                                        </a>
                                    </span>
                                        </div>
                                        <div class="upload-preview text-center upload-preview">
                                            <span class="upload-preview-tip">60&times;57</span>
                                            <img class="upload-preview-img" :src="edit_order.icon">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="form-group-label col-sm-3 text-right">
                                </div>
                                <div class="col-sm-9">
                                    <a class="btn btn-primary edit-order-save" href="javascript:">确认</a>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>

            <div class="modal add-menu-modal" data-backdrop="static" style="z-index: 1041">
                <div class="modal-dialog modal-sm" role="document">
                    <div class="panel">
                        <div class="panel-headers">
                            <span>添加菜单</span>
                            <a href="javascript:" class="panel-close" data-dismiss="modal">×</a>
                        </div>
                        <div class="panel-body clearfix">
                            <div style="background: #f6f8f9;padding: .5rem">
                                <div flex="dir:left box:justify cross:center"
                                     style="padding: .5rem;background: #fff;margin: .25rem 0"
                                     v-if="menu_list" v-for="(item,index) in menu_list">
                                    <div>
                                        <img :src="item.icon" style="width: 21px;height: 21px;display: inline-block">
                                    </div>
                                    <div class="pl-3">{{item.name}}</div>
                                    <div>
                                        <a href="javascript:" class="add-menu a" :data-index="index">添加</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal edit-menu-modal" data-backdrop="static" style="z-index: 1041">
                <div class="modal-dialog" role="document">
                    <div class="panel">
                        <div class="panel-headers">
                            <span>菜单编辑</span>
                            <a href="javascript:" class="panel-close" data-dismiss="modal">×</a>
                        </div>
                        <div class="panel-body" v-if="edit_menu">
                            <div class="form-group row">
                                <div class="form-group-label col-sm-2 text-right">
                                    <label class="col-form-label required">名称</label>
                                </div>
                                <div class="col-sm-8" style="display: inherit;">
                                    <input class="form-control" v-model.lazy="edit_menu.name">
                                </div>
                            </div>
                            <div class="form-group row" v-if="edit_menu.id=='fenxiao'">
                                <div class="form-group-label col-sm-3 text-right">
                                    <label class="col-form-label required">名称2<br>成为分销商</label>
                                </div>
                                <div class="col-sm-9">
                                    <input class="form-control" v-model.lazy="edit_menu.name_1">
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="form-group-label col-sm-2 text-right">
                                    <label class="col-form-label required">图标</label>
                                </div>
                                <div class="col-sm-8">
                                    <div class="upload-group">
                                        <div class="input-group">
                                            <input class="form-control file-input" v-model.lazy="edit_menu.icon"
                                                   name="edit_menu_icon">
                                            <span class="input-group-btn">
                                        <a class="btn btn-secondary upload-file" href="javascript:"
                                           data-toggle="tooltip"
                                           data-placement="bottom" title="上传文件">
                                            <span class="iconfont icon-cloudupload"></span>
                                        </a>
                                    </span>
                                            <span class="input-group-btn">
                                        <a class="btn btn-secondary select-file" href="javascript:"
                                           data-toggle="tooltip"
                                           data-placement="bottom" title="从文件库选择">
                                            <span class="iconfont icon-viewmodule"></span>
                                        </a>
                                    </span>
                                            <span class="input-group-btn">
                                        <a class="btn btn-secondary delete-file" href="javascript:"
                                           data-toggle="tooltip"
                                           data-placement="bottom" title="删除文件">
                                            <span class="iconfont icon-close"></span>
                                        </a>
                                    </span>
                                        </div>
                                        <div class="upload-preview text-center upload-preview">
                                            <span class="upload-preview-tip">50&times;50</span>
                                            <img class="upload-preview-img" :src="edit_menu.icon">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="form-group-label col-sm-2 text-right">
                                </div>
                                <div class="col-sm-8">
                                    <a class="btn btn-primary edit-menu-save" href="javascript:">确认</a>
                                </div>
                            </div>


                        </div>
                    </div>
                </div>
            </div>


        </div>
    </div>
</div>
<script>
    var app = new Vue({
        el: '#app',
        data: {
            user_center_bg: null,
            //orders:null,

            menus: [
                // {icon:"https://xam.chaojiyuanma.com/addons/zjhj_mall/core/web/statics/images/user-center/icon-user-pt.png",id:"pintuan",name:"我的拼团",url:"/pages/pt/order/order"},
                // {icon:"https://xam.chaojiyuanma.com/addons/zjhj_mall/core/web/statics/images/user-center/icon-user-fx.png",id:"fenxiao",name:"分销中心",url:"/pages/pt/order/order"},

            ],
            edit_order: null,
            edit_menu: null,
            menu_list: [
//     	{icon:"https://xam.chaojiyuanma.com/addons/zjhj_mall/core/web/statics/images/user-center/icon-user-pt.png",id:"pintuan",name:"我的拼团",open_type:"navigator",ulr:"/pages/pt/order/order"},
//     	{icon:"https://xam.chaojiyuanma.com/addons/zjhj_mall/core/web/statics/images/user-center/icon-user-yy.png",id:"yuyue",name:"我的预约",open_type:"navigator",ulr:"/pages/pt/order/order"},
//     	{icon:"https://xam.chaojiyuanma.com/addons/zjhj_mall/core/web/statics/images/user-center/icon-user-fx.png",id:"fenxiao",name:"分销中心",name_1:"成为分销商",open_type:"navigator",ulr:"/pages/share/index"},
//     	{icon:"https://xam.chaojiyuanma.com/addons/zjhj_mall/core/web/statics/images/user-center/icon-user-card.png",id:"kaquan",name:"我的卡券",open_type:"navigator",ulr:"/pages/card/card"},
//     	{icon:"https://xam.chaojiyuanma.com/addons/zjhj_mall/core/web/statics/images/user-center/icon-user-yhq.png",id:"youhuiquan",name:"我的优惠券",open_type:"navigator",ulr:"/pages/coupon/coupon"},
// //  	{icon:"https://xam.chaojiyuanma.com/addons/zjhj_mall/core/web/statics/images/user-center/icon-user-pt.png",id:"pintuan",name:"我的拼团",ulr:"/pages/pt/order/order"},
//  	{icon:"https://xam.chaojiyuanma.com/addons/zjhj_mall/core/web/statics/images/user-center/icon-user-pt.png",id:"pintuan",name:"我的拼团",ulr:"/pages/pt/order/order"},
//  	{icon:"https://xam.chaojiyuanma.com/addons/zjhj_mall/core/web/statics/images/user-center/icon-user-pt.png",id:"pintuan",name:"我的拼团",ulr:"/pages/pt/order/order"}
            ],
            copyright: null,
            menu_style: 0,
            top_style: 0,
        },
        computed: {
            c_user_center_bg: function () {
                return this.user_center_bg ? 'background-image:url(' + this.user_center_bg + ');' : '';
            }
        },
    });
    //console.log(app.orders.status_0.icon)		//orders.status_0.text
    $('#app').show();
    var edit_order_index = null;
    var edit_menu_index = null;

    $.ajax({
        dataType: 'json',
        url:'userAjax',
        success: function (res) {
            console.log(res)
            app.user_center_bg = res.data.user_center_bg;
            app.orders = res.data.orders;
            app.menus = res.data.menus;
            app.copyright = res.data.copyright;
            app.menu_list = res.data.menu_list;
            app.menu_style = res.data.menu_style;
            app.top_style = res.data.top_style;
        }
    });

    $(document).on('change', 'input[name="user_center_bg"]', function () {
        app.user_center_bg = $(this).val();
    });
    $(document).on('change', 'input[name="edit_order_icon"]', function () {
        app.edit_order.icon = $(this).val();
    });
    $(document).on('change', 'input[name="edit_menu_icon"]', function () {
        app.edit_menu.icon = $(this).val();
    });
    $(document).on('change', 'input[name="copyright_icon"]', function () {
        app.copyright.icon = $(this).val();
    });
    $(document).on('change', 'input[name="copyright_url"]', function () {
        app.copyright.url = $(this).val();
    });
    $(document).on('change', 'input[name="copyright_open_type"]', function () {
        app.copyright.open_type = $(this).val();
    });

    $(document).on('click', '.edit-order', function () {
        edit_order_index = $(this).attr('data-index');
        app.edit_order = JSON.parse(JSON.stringify(app.orders[edit_order_index]));
        $('.edit-order-modal').modal('show');
    });

    $(document).on('click', '.edit-order-save', function () {
        for (var i in app.edit_order) {
            app.orders[edit_order_index][i] = app.edit_order[i];
        }
        $('.edit-order-modal').modal('hide');
    });

    $(document).on('click', '.add-menu', function () {
        var index = parseInt($(this).attr('data-index'));
        app.menus.push(app.menu_list[index]);
        $('.add-menu-modal').modal('hide');
    });
    $(document).on('click', '.delete-menu', function () {
        var index = parseInt($(this).attr('data-index'));
        app.menus.splice(index, 1);
    });
    $(document).on('click', '.edit-menu', function () {
        edit_menu_index = parseInt($(this).attr('data-index'));
        app.edit_menu = JSON.parse(JSON.stringify(app.menus[edit_menu_index]));
        $('.edit-menu-modal').modal('show');
    });
    $(document).on('click', '.edit-menu-save', function () {
        for (var i in app.edit_menu) {
            app.menus[edit_menu_index][i] = app.edit_menu[i];
        }
        $('.edit-menu-modal').modal('hide');
    });


    $(document).on('click', '.save-user-center', function () {
        var btn = $(this);
        //btn.btnLoading(btn.text());
        $.ajax({
            type: 'post',
            url:'',
            dataType: 'json',
            data: {
                value: JSON.stringify({
                    user_center_bg: app.user_center_bg,
                    // orders: app.orders,
                    menus: app.menus,
                    copyright: app.copyright,
                    menu_style:app.menu_style,
                    top_style:app.top_style,
                }),
            },
            success: function (res) {
                $.alert({
                    content: res.msg,
                    confirm: function () {
                        if (res.code == 0) {
                            location.reload();
                        } else {
                            btn.btnReset();
                        }
                    }
                });
            }
        });
    });

</script>

<script>
    // var group_url = '/addons/zjhj_mall/core/web/index.php?r=mch%2Ffile%2Fgroup';
    // //添加分组
    // $(document).on('click', '.add-group', function () {
    //     var group = {
    //         name: '未命名',
    //         is_default: 0
    //     };
    //     saveGroup(group);
    // });

    // //保存单个分组信息
    // function saveGroup(group){
    //     $.ajax({
    //         url:"/addons/zjhj_mall/core/web/index.php?r=mch%2Ffile%2Fedit-group-one",
    //         dataType:'json',
    //         type:'post',
    //         data:{
    //             _csrf:_csrf,
    //             data:JSON.stringify(group)
    //         },
    //         success:function(res){
    //             if(res.code == 0){
    //                 file_app.group_list = res.data;
    //             }else{
    //                 $.myAlert({
    //                     content:res.smg
    //                 });
    //             }
    //         }
    //     });
    // }

    //选择分组
    $(document).on('click', '.selected-group', function (event) {
        file_app.selected = $(this).data('index');
        $("input[name='checkbox']").prop('checked', false);
        file_app.edit_group = -1;
        file_app.edit_setting = -1;
        getGroupFile();
    });

    //打开设置
    $(document).on('click', '.setting-group', function (event) {
        event.stopPropagation();//阻止事件冒泡；
        var index = $(this).data('index');
        file_app.edit_group = -1;
        file_app.selected = index;
        if (file_app.edit_setting == index) {
            file_app.edit_setting = -1;
        } else {
            file_app.edit_setting = index;
        }
        getGroupFile();
    });

    //编辑分组
    $(document).on('click', '.edit-group', function (event) {
        event.stopPropagation();//阻止事件冒泡；
        var index = $(this).data('index');
        file_app.edit_group = -1;
        file_app.edit_setting = -1;
        file_app.edit_group = index;
    });

    //删除分组
    $(document).on('click', '.delete-group', function (event) {
        event.stopPropagation();//阻止事件冒泡；
        var index = $(this).data('index');
        file_app.edit_group = -1;
        file_app.edit_setting = -1;
        file_app.selected = 0;
        var group = file_app.group_list[index];
        if (group.id) {
            group.is_delete = '1';
        } else {
            file_app.group_list.splice(index, 1);
        }
        saveGroup(group);
    });

    //确定修改
    $(document).on('click', '.save-group', function (event) {
        event.stopPropagation();//阻止事件冒泡；
        var group = file_app.group_list[file_app.edit_group];
        group.name = $('.name-group').val();
        file_app.edit_group = -1;
        file_app.edit_setting = -1;
        saveGroup(group);
    });

    //取消修改
    $(document).on('click', '.cancel-group', function (event) {
        event.stopPropagation();//阻止事件冒泡；
        file_app.edit_group = -1;
        file_app.edit_setting = -1;
    });

    //阻止冒泡事件
    $(document).on('click', '.name-group', function (event) {
        event.stopPropagation();//阻止事件冒泡；
    });

    //保存
    $(document).on('click', '.save-group-list', function () {
        if (file_app.file_list.length > 0) {
            var item = file_app.file_list[0];
            if (typeof _file_select.success === 'function') {
                _file_select.success({
                    name: item.file_url,
                    url: item.file_url,
                });
            }
        }
        file_app.file_list = [];
        file_app.list = [];
        file_app.selected = 0;
        file_app.edit_group = -1;
        file_app.edit_setting = -1;
        $('#file_select_modal').modal('hide');
    });

    //取消
    $(document).on('click', '.cancel-group-list', function () {
        file_app.file_list = [];
        file_app.list = [];
        file_app.selected = 0;
        file_app.edit_group = -1;
        file_app.edit_setting = -1;
        $('#file_select_modal').modal('hide');
    });

    //全选图片
    $(document).on('change', "input[name='checkbox']", function () {
        var list = file_app.list;
        file_app.file_list = [];
        $(list).each(function (i) {
            if ($("input[name='checkbox']:checked").val() == 1) {
                list[i].selected = 1;
                var file = list[i];
                file_app.file_list.push(file);
            } else {
                list[i].selected = 0;
            }
        });
        addFile()
    });

    //选择图片
    $(document).on('click', '#file_select_modal .file-item', function () {
        var index = $(this).data('index');
        file_app.file_list = [];
        if (file_app.list[index].selected == 1) {
            file_app.list[index].selected = 0;
        } else {
            file_app.list[index].selected = 1;
        }
        $("input[name='checkbox']").prop('checked', false);
        addFile()
    });

    //选中的图片
    function addFile() {
        var list = file_app.list;
        file_app.file_list = [];
        $(list).each(function (i) {
            if (list[i].selected == 1) {
                var file = list[i];
                file_app.file_list.push(file);
            }
        });
    }

    //删除选中的图片
    $(document).on('click', '.delete-file-group', function () {
        var file_list = file_app.file_list;
        if (file_list.length == 0) {
            $.myAlert({
                content: '请先勾选需要删除的图片'
            });
            return false;
        }
        $.ajax({
            url: "/addons/zjhj_mall/core/web/index.php?r=mch%2Ffile%2Fdelete",
            dataType: 'json',
            type: 'post',
            data: {
                _csrf: _csrf,
                data: JSON.stringify(file_list)
            },
            success: function (res) {
                if (res.code == 0) {
                    var list = file_app.list;
                    var new_list = [];
                    $(list).each(function (i) {
                        if (list[i].selected != 1) {
                            new_list.push(list[i]);
                        }
                    });
                    file_app.list = new_list;
                    file_app.file_list = [];
                    $("input[name='checkbox']").prop('checked', false);
                    $.myAlert({
                        content: '删除成功'
                    });
                } else {
                    $.myAlert({
                        content: res.msg
                    });
                }
            }
        });
    });

    //移动图片到某个分组
    $(document).on('click', '.batch-group', function () {
        var file_list = file_app.file_list;
        var index = $(this).data('index');
        if (file_list.length == 0) {
            $.myAlert({
                content: '请先勾选需要删除的图片'
            });
            return false;
        }
        $.ajax({
            url: "/addons/zjhj_mall/core/web/index.php?r=mch%2Ffile%2Fmove",
            dataType: 'json',
            type: 'post',
            data: {
                _csrf: _csrf,
                data: JSON.stringify(file_list),
                group_id: file_app.group_list[index].id
            },
            success: function (res) {
                if (res.code == 0) {
                    file_app.file_list = [];
                    $("input[name='checkbox']").prop('checked', false);
                    file_app.selected = index;
                    getGroupFile();
                    $.myAlert({
                        content: '移动成功'
                    });
                } else {
                    $.myAlert({
                        content: res.msg
                    });
                }
            }
        });
    });

    //获得分组下的图片
    function getGroupFile() {
        var more_btn = $('#file_select_modal .file-more');
        var loading_block = $('#file_select_modal .file-loading');
        var group_id = file_app.group_list[file_app.selected].id;
        loading_block.show();
        more_btn.hide();
        $.ajax({
            url: _upload_file_list_url,
            data: {
                dataType: 'json',
                type: 'image',
                page: 1,
                group_id: group_id
            },
            success: function (res) {
                more_btn.attr('data-page', 2);
                loading_block.hide();
                more_btn.show();
                file_app.list = res.data.list;
            }
        });
    }
    //上传图片
    $(document).on('click', '.upload-group .upload-file-group', function () {
        var group_id = file_app.group_list[file_app.selected].id;
        if (group_id <= 0) {
            group_id = 0;
        }
        var btn = $(this);
        var group = btn.parents('.upload-group');
        var input = group.find('.file-input');
        var preview = group.find('.upload-preview');
        var preview_img = group.find('.upload-preview-img');
        $.upload_file({
            url: _upload_url + '&group_id=' + group_id,
            accept: group.attr('accept') || 'image/*',
            start: function () {
                btn.btnLoading(btn.text());
            },
            success: function (res) {
                btn.btnReset();
                getGroupFile();
            },
        });
    });
</script>

{/block}